<% layout('layouts/boilerplate') -%>

<div class="container">
    <h2 class="form-title">Create New Post</h2>
    <form class="newcontainer" action="/" method="POST" id="postForm">
        <div class="form-group floating">
            <input type="text" name="post[image]" id="image" required placeholder=" ">
            <label for="image">Image URL</label>
            <span class="focus-border"></span>
            <i class="icon fas fa-image"></i>
        </div>
        
        <div class="form-group floating">
            <input type="text" name="post[title]" id="title" required placeholder=" ">
            <label for="title">Title</label>
            <span class="focus-border"></span>
            <i class="icon fas fa-heading"></i>
        </div>
        
        <div class="form-group floating">
            <input type="text" name="post[caption]" id="caption" required placeholder=" ">
            <label for="caption">Caption</label>
            <span class="focus-border"></span>
            <i class="icon fas fa-comment-alt"></i>
        </div>
        
        <div class="form-actions">
            <button type="submit" class="glow-button create-btn">
                <span class="button-text">Create Post</span>
                <span class="button-icon"><i class="fas fa-plus-circle"></i></span>
            </button>
            
            <button type="button" class="glow-button cancel-btn" id="cancelButton">
                <span class="button-text">Cancel</span>
                <span class="button-icon"><i class="fas fa-times"></i></span>
            </button>
        </div>
    </form>
</div>


<style>


</style>

<script>
// Form change detection
const form = document.getElementById('postForm');
const cancelBtn = document.getElementById('cancelButton');
let formChanged = false;

// Detect form changes
form.querySelectorAll('input').forEach(input => {
    input.addEventListener('input', () => {
        formChanged = true;
    });
});

// Cancel button handler
cancelBtn.addEventListener('click', () => {
    if (formChanged) {
        showCancelModal();
    } else {
        window.location.href = "/";
    }
});

function showCancelModal() {
    document.getElementById('cancelModal').style.display = 'block';
}

function hideCancelModal() {
    document.getElementById('cancelModal').style.display = 'none';
}

// Close modal when clicking outside content
window.onclick = function(event) {
    const modal = document.getElementById('cancelModal');
    if (event.target == modal) {
        hideCancelModal();
    }
}
</script>