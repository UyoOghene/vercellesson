<% layout('layouts/boilerplate') -%>

<div id="showcontainer">

<h1 class="text"><%= post.title %></h1>

<img src="<%= post.image.startsWith('/') ? post.image : '/' + post.image %>"><p class="text" ><%= post.caption %></p>


<div id="editndel">
    <span><a href="/posts/<%= post._id %>/edit">  <img id="editimg" class="icon" src="/images/edit2.png" alt=""> </a></span>
    <span><form action="/posts/<%= post._id %>?_method=DELETE" method="post">
        <button id="delbtnbtn" > <img id="delbtn" class="icon" src="/images/delete.png" alt=""> </button>
    </form></span>
</div>

<form action="/posts/<%= post._id %>/comments" method="post" >
    <div class="mb-3">
        <label for="body" class="form-label">Add a Comment</label>
        <textarea  name="comment[body]" id="body" cols="10" rows="3" required></textarea>
        <div class="valid-feedback">Looks Good</div>
    </div>
    <button class="btn btn-success">Submit comment</button>
    </form>
    <% if (post.comments && post.comments.length > 0) { %>
        <div class="comments-section">
            <h3>Comments</h3>
            <% post.comments.forEach(comment => { %>
            <div class="comment">
                <p><%= comment.body %></p>
                <small><%= comment.createdAt.toLocaleDateString() %></small>
                <form action="/posts/<%= post._id %>/comments/<%= comment._id %>?_method=DELETE" method="post">
                    <button type="submit" class="btn btn-danger btn-sm">Delete</button>
                </form>
            </div>
            <% }); %>
        </div>
        <% } %>



    <a class="text" href="/posts">Back to all posts</a>

</div>

